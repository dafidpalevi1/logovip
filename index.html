<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VIP Agency Generator</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700;900&family=Poppins:wght@600;700;900&family=Roboto:wght@600;700;900&family=Lato&family=Oswald&family=Raleway&family=Merriweather&family=Playfair+Display&family=Open+Sans&family=Lora&family=Ubuntu&family=Source+Sans+Pro&family=Noto+Sans&family=Cabin&family=Exo+2&family=Cormorant+Garamond&family=Fira+Sans&family=Kanit&family=Nunito&family=Quicksand&family=Dosis&family=Rubik&family=Bitter&family=Alegreya+Sans&family=Titillium+Web&family=Muli&family=Questrial&family=Vollkorn&family=Anton&family=Bebas+Neue&family=Indie+Flower&family=Pacifico&family=Lobster&family=Dancing+Script&family=Abril+Fatface&family=Kaushan+Script&family=Crete+Round&family=Cinzel&family=Teko&family=Saira+Condensed&family=Hind+Siliguri&family=Poiret+One&family=Jura&family=Asap&family=PT+Sans&family=Fjalla+One&family=Chivo&family=Arvo&family=Josefin+Sans&family=Comfortaa&family=Amatic+SC&family=Righteous&family=Permanent+Marker&family=Passion+One&family=Archivo+Narrow&family=Varela+Round&family=Patua+One&family=Bungee&family=Alfa+Slab+One&family=Ultra&family=Special+Elite&family=Press+Start+2P&family=Bangers&family=Russo+One&family=Orbitron&family=Monoton&family=Fugaz+One&family=Graduate&family=Electrolize&family=Exo&family=Squada+One&family=Bevan&family=Limelight&family=Syncopate&family=Six+Caps&family=Ceviche+One&family=Faster+One&family=Metal+Mania&family=Nosifier&family=Rye&family=Sancreek&family=Trade+Winds&family=Wallpoet&family=Yatra+One&family=Akronim&family=Butcherman&family=Chango&family=Creepster&family=Eater&family=Flavors&family=Gochi+Hand&family=Henny+Penny&family=Holtwood+One+SC&family=Jolly+Lodger&family=Kavoon&family=Knewave&family=Lalezar&family=Leckerli+One&family=Love+Ya+Like+A+Sister&family=Macondo&family=Luckiest+Guy&family=Neucha&display=swap" rel="stylesheet">
<style>
body {
  display: flex;
  flex-direction: column;
  align-items: center;
  background: #000;
  min-height: 100vh;
  margin: 0;
  padding: 20px 10px;
  font-family: 'Montserrat', sans-serif;
  color: white;
}
.container {
  position: relative;
  width: 100%;
  max-width: 644px;
  aspect-ratio: 1/1;
  background: #111;
}
.container img.bg { width: 100%; height: 100%; object-fit: cover; display: block; }
#photo-wrapper {
  position: absolute;
  top: 50%; left: 50%;
  width: 45%; height: 45%;
  transform: translate(-50%,-50%);
  display: none;
  z-index:2;
}
#user-photo { width: 100%; height:100%; object-fit: cover; cursor: move; border: 2px dashed rgba(255,255,255,0.4); touch-action: none; }
.resize-handle {
  position: absolute;
  width:14px; height:14px;
  background: gold;
  border:2px solid black;
  border-radius:50%;
  z-index:5;
  touch-action:none;
}
.resize-handle.br { bottom:-8px; right:-8px; cursor: se-resize;}
.resize-handle.bl { bottom:-8px; left:-8px; cursor: sw-resize;}
.resize-handle.tr { top:-8px; right:-8px; cursor: ne-resize;}
.resize-handle.tl { top:-8px; left:-8px; cursor: nw-resize;}
.resize-handle.ml { top:50%; left:-8px; transform:translateY(-50%); cursor:w-resize;}
.resize-handle.mr { top:50%; right:-8px; transform:translateY(-50%); cursor:e-resize;}
.resize-handle.mt { top:-8px; left:50%; transform:translateX(-50%); cursor:n-resize;}
.resize-handle.mb { bottom:-8px; left:50%; transform:translateX(-50%); cursor:s-resize;}
#overlay { position:absolute; top:0; left:0; width:100%; height:100%; object-fit:cover; pointer-events:none; z-index:3; }
#papan-nama {
  position:absolute; bottom:16%; left:50%; transform:translateX(-50%);
  color:#fff; font-size:30px; font-weight:900; text-align:center;
  width:80%; font-family:'Montserrat',sans-serif;
  text-shadow: -2px -2px 4px rgba(0,0,0,0.8),
                2px -2px 4px rgba(0,0,0,0.8),
               -2px 2px 4px rgba(0,0,0,0.8),
                2px 2px 4px rgba(0,0,0,0.8);
  z-index:4;
}
.controls {
  margin-top:20px;
  display:flex;
  flex-direction:column;
  gap:10px;
  align-items:center;
  width:100%;
  max-width:420px;
}
input[type="text"], button, label, select, input[type="range"] {
  padding:10px 14px;
  border-radius:6px;
  border:none;
  font-size:16px;
  font-family:'Montserrat',sans-serif;
  width:100%;
  box-sizing:border-box;
}
button,label { cursor:pointer; background: gold; color:black; font-weight:700; text-align:center; }
#upload-photo { display:none; }
.btn-row { display:flex; flex-wrap:wrap; gap:10px; width:100%; }
.btn-row > * { flex:1; min-width:120px; }
.font-controls,.size-controls { display:flex; gap:10px; width:100%; }
.font-controls > *, .size-controls > * { flex:1; }
#size-slider { display:none; margin-top:5px; }
#size-label {
    color: black;
}
</style>
</head>
<body>
<div class="container" id="capture-area">
  <img class="bg" src="image/logoku.jpeg" alt="VIP Agency Background">
  <div id="photo-wrapper">
    <img id="user-photo" src="" alt="">
    <div class="resize-handle tl"></div>
    <div class="resize-handle tr"></div>
    <div class="resize-handle bl"></div>
    <div class="resize-handle br"></div>
    <div class="resize-handle ml"></div>
    <div class="resize-handle mr"></div>
    <div class="resize-handle mt"></div>
    <div class="resize-handle mb"></div>
  </div>
  <img id="overlay" src="image/lapisan.png" alt="Overlay">
  <div id="papan-nama">Tulis Nama</div>
</div>

<div class="controls">
  <input type="text" id="nama-input" placeholder="Masukkan nama">

  <div class="font-controls">
    <select id="font-select">
      <option value="Montserrat">Montserrat</option>
      <option value="Poppins">Poppins</option>
      <option value="Roboto">Roboto</option>
      <option value="Lato">Lato</option>
      <option value="Oswald">Oswald</option>
      <option value="Raleway">Raleway</option>
      <option value="Merriweather">Merriweather</option>
      <option value="Playfair Display">Playfair Display</option>
      <option value="Open Sans">Open Sans</option>
      <option value="Lora">Lora</option>
      <option value="Ubuntu">Ubuntu</option>
      <option value="Source Sans Pro">Source Sans Pro</option>
      <option value="Noto Sans">Noto Sans</option>
      <option value="Cabin">Cabin</option>
      <option value="Exo 2">Exo 2</option>
      <option value="Cormorant Garamond">Cormorant Garamond</option>
      <option value="Fira Sans">Fira Sans</option>
      <option value="Kanit">Kanit</option>
      <option value="Nunito">Nunito</option>
      <option value="Quicksand">Quicksand</option>
      <option value="Dosis">Dosis</option>
      <option value="Rubik">Rubik</option>
      <option value="Bitter">Bitter</option>
      <option value="Alegreya Sans">Alegreya Sans</option>
      <option value="Titillium Web">Titillium Web</option>
      <option value="Muli">Muli</option>
      <option value="Questrial">Questrial</option>
      <option value="Vollkorn">Vollkorn</option>
      <option value="Anton">Anton</option>
      <option value="Bebas Neue">Bebas Neue</option>
      <option value="Indie Flower">Indie Flower</option>
      <option value="Pacifico">Pacifico</option>
      <option value="Lobster">Lobster</option>
      <option value="Dancing Script">Dancing Script</option>
      <option value="Abril Fatface">Abril Fatface</option>
      <option value="Kaushan Script">Kaushan Script</option>
      <option value="Crete Round">Crete Round</option>
      <option value="Cinzel">Cinzel</option>
      <option value="Teko">Teko</option>
      <option value="Saira Condensed">Saira Condensed</option>
      <option value="Hind Siliguri">Hind Siliguri</option>
      <option value="Poiret One">Poiret One</option>
      <option value="Jura">Jura</option>
      <option value="Asap">Asap</option>
      <option value="PT Sans">PT Sans</option>
      <option value="Fjalla One">Fjalla One</option>
      <option value="Chivo">Chivo</option>
      <option value="Arvo">Arvo</option>
      <option value="Josefin Sans">Josefin Sans</option>
      <option value="Comfortaa">Comfortaa</option>
      <option value="Amatic SC">Amatic SC</option>
      <option value="Righteous">Righteous</option>
      <option value="Permanent Marker">Permanent Marker</option>
      <option value="Passion One">Passion One</option>
      <option value="Archivo Narrow">Archivo Narrow</option>
      <option value="Varela Round">Varela Round</option>
      <option value="Patua One">Patua One</option>
      <option value="Bungee">Bungee</option>
      <option value="Alfa Slab One">Alfa Slab One</option>
      <option value="Ultra">Ultra</option>
      <option value="Special Elite">Special Elite</option>
      <option value="Press Start 2P">Press Start 2P</option>
      <option value="Bangers">Bangers</option>
      <option value="Russo One">Russo One</option>
      <option value="Orbitron">Orbitron</option>
      <option value="Monoton">Monoton</option>
      <option value="Fugaz One">Fugaz One</option>
      <option value="Graduate">Graduate</option>
      <option value="Electrolize">Electrolize</option>
      <option value="Exo">Exo</option>
      <option value="Squada One">Squada One</option>
      <option value="Bevan">Bevan</option>
      <option value="Limelight">Limelight</option>
      <option value="Syncopate">Syncopate</option>
      <option value="Six Caps">Six Caps</option>
      <option value="Ceviche One">Ceviche One</option>
      <option value="Faster One">Faster One</option>
      <option value="Metal Mania">Metal Mania</option>
      <option value="Nosifier">Nosifier</option>
      <option value="Rye">Rye</option>
      <option value="Sancreek">Sancreek</option>
      <option value="Trade Winds">Trade Winds</option>
      <option value="Wallpoet">Wallpoet</option>
      <option value="Yatra One">Yatra One</option>
      <option value="Akronim">Akronim</option>
      <option value="Butcherman">Butcherman</option>
      <option value="Chango">Chango</option>
      <option value="Creepster">Creepster</option>
      <option value="Eater">Eater</option>
      <option value="Flavors">Flavors</option>
      <option value="Gochi Hand">Gochi Hand</option>
      <option value="Henny Penny">Henny Penny</option>
      <option value="Holtwood One SC">Holtwood One SC</option>
      <option value="Jolly Lodger">Jolly Lodger</option>
      <option value="Kavoon">Kavoon</option>
      <option value="Knewave">Knewave</option>
      <option value="Lalezar">Lalezar</option>
      <option value="Leckerli One">Leckerli One</option>
      <option value="Love Ya Like A Sister">Love Ya Like A Sister</option>
      <option value="Macondo">Macondo</option>
      <option value="Luckiest Guy">Luckiest Guy</option>
      <option value="Neucha">Neucha</option>
    </select>
    <input type="color" id="font-color" value="#ffffff">
  </div>

  <div class="size-controls">
    <label id="size-label">Ukuran</label>
  </div>
  <input type="range" id="size-slider" min="12" max="80" value="30">

  <div class="btn-row">
    <label for="upload-photo">Upload Gambar</label>
    <input type="file" id="upload-photo" accept="image/*">
    <button id="remove-bg-btn">Remove Background</button>
    <button id="download-btn">Download</button>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/dom-to-image/2.6.0/dom-to-image.min.js"></script>
<script>
const namaInput = document.getElementById("nama-input");
const papanNama = document.getElementById("papan-nama");
const uploadPhoto = document.getElementById("upload-photo");
const userPhoto = document.getElementById("user-photo");
const photoWrapper = document.getElementById("photo-wrapper");
const downloadBtn = document.getElementById("download-btn");
const captureArea = document.getElementById("capture-area");
const fontSelect = document.getElementById("font-select");
const fontColor = document.getElementById("font-color");
const sizeLabel = document.getElementById("size-label");
const sizeSlider = document.getElementById("size-slider");
const removeBgBtn = document.getElementById("remove-bg-btn");

// Update nama
namaInput.addEventListener("input", () => { papanNama.textContent = namaInput.value; });

// Ganti font
fontSelect.addEventListener("change", () => { papanNama.style.fontFamily = fontSelect.value + ", sans-serif"; });

// Ganti warna font
fontColor.addEventListener("input", () => { papanNama.style.color = fontColor.value; });

// Toggle slider muncul
sizeLabel.addEventListener("click", () => {
  sizeSlider.style.display = sizeSlider.style.display === "block" ? "none" : "block";
});

// Ganti ukuran font
sizeSlider.addEventListener("input", () => { papanNama.style.fontSize = sizeSlider.value + "px"; });

// Upload foto
uploadPhoto.addEventListener("change", (e)=>{
  const file = e.target.files[0];
  if(file){
    const reader = new FileReader();
    reader.onload = function(evt){
      userPhoto.src = evt.target.result;
      photoWrapper.style.display = "block";
    };
    reader.readAsDataURL(file);
  }
});

// Remove Background
removeBgBtn.addEventListener("click", async ()=>{
  if(!userPhoto.src) return alert("Upload gambar dulu!");
  removeBgBtn.textContent = "Processing...";
  
  try {
    const file = dataURLtoFile(userPhoto.src,"userphoto.png");
    const formData = new FormData();
    formData.append("image_file", file);
    formData.append("size", "auto");

    const response = await fetch("https://api.remove.bg/v1.0/removebg", {
      method: "POST",
      headers: {
        "X-Api-Key": "AqDpBNSTdD88885CEJBkER5o"
      },
      body: formData
    });

    if(!response.ok) throw new Error("Gagal remove background");

    const blob = await response.blob();
    const url = URL.createObjectURL(blob);
    userPhoto.src = url;
    photoWrapper.style.display = "block";
  } catch(err) {
    alert("Error: " + err.message);
  } finally {
    removeBgBtn.textContent = "Remove Background";
  }
});

// Helper: dataURL -> File
function dataURLtoFile(dataurl, filename) {
  let arr = dataurl.split(','), mime = arr[0].match(/:(.*?);/)[1],
  bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);
  while(n--){ u8arr[n] = bstr.charCodeAt(n); }
  return new File([u8arr], filename, {type:mime});
}

// Drag & Resize
let isDragging=false,dragX,dragY;
function startDrag(x,y){isDragging=true; dragX=x-photoWrapper.offsetLeft; dragY=y-photoWrapper.offsetTop;}
function doDrag(x,y){if(isDragging){photoWrapper.style.left=(x-dragX)+"px"; photoWrapper.style.top=(y-dragY)+"px";}}
function endDrag(){isDragging=false;}
photoWrapper.addEventListener("mousedown",(e)=>{if(!e.target.classList.contains("resize-handle")) startDrag(e.clientX,e.clientY);});
document.addEventListener("mousemove",(e)=>doDrag(e.clientX,e.clientY));
document.addEventListener("mouseup",endDrag);
photoWrapper.addEventListener("touchstart",(e)=>{if(!e.target.classList.contains("resize-handle")){const t=e.touches[0]; startDrag(t.clientX,t.clientY);}});
document.addEventListener("touchmove",(e)=>{if(isDragging){const t=e.touches[0]; doDrag(t.clientX,t.clientY);}});
document.addEventListener("touchend",endDrag);

// Resize handles
const handles = document.querySelectorAll(".resize-handle");
let isResizing=false,currentHandle,startX,startY,startWidth,startHeight,startLeft,startTop,aspectRatio;
function startResize(x,y,handle){isResizing=true; currentHandle=handle; startX=x; startY=y; startWidth=photoWrapper.offsetWidth; startHeight=photoWrapper.offsetHeight; startLeft=photoWrapper.offsetLeft; startTop=photoWrapper.offsetTop; aspectRatio=startWidth/startHeight;}
function doResize(x,y){if(!isResizing)return; let dx=x-startX,dy=y-startY; 
if(currentHandle.classList.contains("br")){let w=startWidth+dx,h=w/aspectRatio; photoWrapper.style.width=w+"px"; photoWrapper.style.height=h+"px";}
else if(currentHandle.classList.contains("bl")){let w=startWidth-dx,h=w/aspectRatio; photoWrapper.style.width=w+"px"; photoWrapper.style.height=h+"px"; photoWrapper.style.left=startLeft+dx+"px";}
else if(currentHandle.classList.contains("tr")){let w=startWidth+dx,h=w/aspectRatio; photoWrapper.style.width=w+"px"; photoWrapper.style.height=h+"px"; photoWrapper.style.top=startTop+(startHeight-h)+"px";}
else if(currentHandle.classList.contains("tl")){let w=startWidth-dx,h=w/aspectRatio; photoWrapper.style.width=w+"px"; photoWrapper.style.height=h+"px"; photoWrapper.style.left=startLeft+dx+"px"; photoWrapper.style.top=startTop+(startHeight-h)+"px";}
else if(currentHandle.classList.contains("ml")){photoWrapper.style.width=startWidth-dx+"px"; photoWrapper.style.left=startLeft+dx+"px";}
else if(currentHandle.classList.contains("mr")){photoWrapper.style.width=startWidth+dx+"px";}
else if(currentHandle.classList.contains("mt")){photoWrapper.style.height=startHeight-dy+"px"; photoWrapper.style.top=startTop+dy+"px";}
else if(currentHandle.classList.contains("mb")){photoWrapper.style.height=startHeight+dy+"px";}}
function endResize(){isResizing=false;}
handles.forEach(h=>{
  h.addEventListener("mousedown",e=>{startResize(e.clientX,e.clientY,e.target); e.stopPropagation();});
  h.addEventListener("touchstart",e=>{const t=e.touches[0]; startResize(t.clientX,t.clientY,e.target); e.stopPropagation();});
});
document.addEventListener("mousemove",e=>doResize(e.clientX,e.clientY));
document.addEventListener("mouseup",endResize);
document.addEventListener("touchmove",e=>{const t=e.touches[0]; doResize(t.clientX,t.clientY);});
document.addEventListener("touchend",endResize);

// Auto hide resize
document.addEventListener("click",()=>{userPhoto.style.border="none"; handles.forEach(h=>h.style.display="none");});
photoWrapper.addEventListener("click",(e)=>{userPhoto.style.border="2px dashed rgba(255,255,255,0.4)"; handles.forEach(h=>h.style.display="block"); e.stopPropagation();});

// Download
downloadBtn.addEventListener("click",()=>{
  const oldBorder=userPhoto.style.border;
  userPhoto.style.border="none"; handles.forEach(h=>h.style.display="none");

  // Options for higher quality download
  const options = {
    quality: 0.95,
    width: 644 * 2,
    height: 644 * 2
  };

  domtoimage.toPng(captureArea, options)
  .then(function (dataUrl) {
    const link = document.createElement('a');
    link.download = 'vip-agency.png';
    link.href = dataUrl;
    link.click();
    userPhoto.style.border=oldBorder; handles.forEach(h=>h.style.display="block");
  })
  .catch(function (error) {
    console.error('oops, something went wrong!', error);
    alert('Maaf, terjadi kesalahan saat mengunduh gambar.');
  });
});
</script>
</body>
</html>
.resize-handle {
  position: absolute;
  width:14px; height:14px;
  background: gold;
  border:2px solid black;
  border-radius:50%;
  z-index:5;
  touch-action:none;
}
.resize-handle.br { bottom:-8px; right:-8px; cursor: se-resize;}
.resize-handle.bl { bottom:-8px; left:-8px; cursor: sw-resize;}
.resize-handle.tr { top:-8px; right:-8px; cursor: ne-resize;}
.resize-handle.tl { top:-8px; left:-8px; cursor: nw-resize;}
.resize-handle.ml { top:50%; left:-8px; transform:translateY(-50%); cursor:w-resize;}
.resize-handle.mr { top:50%; right:-8px; transform:translateY(-50%); cursor:e-resize;}
.resize-handle.mt { top:-8px; left:50%; transform:translateX(-50%); cursor:n-resize;}
.resize-handle.mb { bottom:-8px; left:50%; transform:translateX(-50%); cursor:s-resize;}
#overlay { position:absolute; top:0; left:0; width:100%; height:100%; object-fit:cover; pointer-events:none; z-index:3; }
#papan-nama {
  position:absolute; bottom:16%; left:50%; transform:translateX(-50%);
  color:#fff; font-size:30px; font-weight:900; text-align:center;
  width:80%; font-family:'Montserrat',sans-serif;
  text-shadow: -2px -2px 4px rgba(0,0,0,0.8),
                2px -2px 4px rgba(0,0,0,0.8),
               -2px 2px 4px rgba(0,0,0,0.8),
                2px 2px 4px rgba(0,0,0,0.8);
  z-index:4;
}
.controls {
  margin-top:20px;
  display:flex;
  flex-direction:column;
  gap:10px;
  align-items:center;
  width:100%;
  max-width:420px;
}
input[type="text"], button, label, select, input[type="range"] {
  padding:10px 14px;
  border-radius:6px;
  border:none;
  font-size:16px;
  font-family:'Montserrat',sans-serif;
  width:100%;
  box-sizing:border-box;
}
button,label { cursor:pointer; background: gold; color:black; font-weight:700; text-align:center; }
#upload-photo { display:none; }
.btn-row { display:flex; flex-wrap:wrap; gap:10px; width:100%; }
.btn-row > * { flex:1; min-width:120px; }
.font-controls,.size-controls { display:flex; gap:10px; width:100%; }
.font-controls > *, .size-controls > * { flex:1; }
#size-slider { display:none; margin-top:5px; }
#size-label {
    color: black;
}
</style>
</head>
<body>
<div class="container" id="capture-area">
  <img class="bg" src="image/logoku.jpeg" alt="VIP Agency Background">
  <div id="photo-wrapper">
    <img id="user-photo" src="" alt="">
    <div class="resize-handle tl"></div>
    <div class="resize-handle tr"></div>
    <div class="resize-handle bl"></div>
    <div class="resize-handle br"></div>
    <div class="resize-handle ml"></div>
    <div class="resize-handle mr"></div>
    <div class="resize-handle mt"></div>
    <div class="resize-handle mb"></div>
  </div>
  <img id="overlay" src="image/lapisan.png" alt="Overlay">
  <div id="papan-nama">Tulis Nama</div>
</div>

<div class="controls">
  <input type="text" id="nama-input" placeholder="Masukkan nama">

  <div class="font-controls">
    <select id="font-select">
      <option value="Montserrat">Montserrat</option>
      <option value="Poppins">Poppins</option>
      <option value="Roboto">Roboto</option>
      <option value="Lato">Lato</option>
      <option value="Oswald">Oswald</option>
      <option value="Raleway">Raleway</option>
      <option value="Merriweather">Merriweather</option>
      <option value="Playfair Display">Playfair Display</option>
      <option value="Open Sans">Open Sans</option>
      <option value="Lora">Lora</option>
      <option value="Ubuntu">Ubuntu</option>
      <option value="Source Sans Pro">Source Sans Pro</option>
      <option value="Noto Sans">Noto Sans</option>
      <option value="Cabin">Cabin</option>
      <option value="Exo 2">Exo 2</option>
      <option value="Cormorant Garamond">Cormorant Garamond</option>
      <option value="Fira Sans">Fira Sans</option>
      <option value="Kanit">Kanit</option>
      <option value="Nunito">Nunito</option>
      <option value="Quicksand">Quicksand</option>
      <option value="Dosis">Dosis</option>
      <option value="Rubik">Rubik</option>
      <option value="Bitter">Bitter</option>
      <option value="Alegreya Sans">Alegreya Sans</option>
      <option value="Titillium Web">Titillium Web</option>
      <option value="Muli">Muli</option>
      <option value="Questrial">Questrial</option>
      <option value="Vollkorn">Vollkorn</option>
      <option value="Anton">Anton</option>
      <option value="Bebas Neue">Bebas Neue</option>
      <option value="Indie Flower">Indie Flower</option>
      <option value="Pacifico">Pacifico</option>
      <option value="Lobster">Lobster</option>
      <option value="Dancing Script">Dancing Script</option>
      <option value="Abril Fatface">Abril Fatface</option>
      <option value="Kaushan Script">Kaushan Script</option>
      <option value="Crete Round">Crete Round</option>
      <option value="Cinzel">Cinzel</option>
      <option value="Teko">Teko</option>
      <option value="Saira Condensed">Saira Condensed</option>
      <option value="Hind Siliguri">Hind Siliguri</option>
      <option value="Poiret One">Poiret One</option>
      <option value="Jura">Jura</option>
      <option value="Asap">Asap</option>
      <option value="PT Sans">PT Sans</option>
      <option value="Fjalla One">Fjalla One</option>
      <option value="Chivo">Chivo</option>
      <option value="Arvo">Arvo</option>
      <option value="Josefin Sans">Josefin Sans</option>
      <option value="Comfortaa">Comfortaa</option>
      <option value="Amatic SC">Amatic SC</option>
      <option value="Righteous">Righteous</option>
      <option value="Permanent Marker">Permanent Marker</option>
      <option value="Passion One">Passion One</option>
      <option value="Archivo Narrow">Archivo Narrow</option>
      <option value="Varela Round">Varela Round</option>
      <option value="Patua One">Patua One</option>
      <option value="Bungee">Bungee</option>
      <option value="Alfa Slab One">Alfa Slab One</option>
      <option value="Ultra">Ultra</option>
      <option value="Special Elite">Special Elite</option>
      <option value="Press Start 2P">Press Start 2P</option>
      <option value="Bangers">Bangers</option>
      <option value="Russo One">Russo One</option>
      <option value="Orbitron">Orbitron</option>
      <option value="Monoton">Monoton</option>
      <option value="Fugaz One">Fugaz One</option>
      <option value="Graduate">Graduate</option>
      <option value="Electrolize">Electrolize</option>
      <option value="Exo">Exo</option>
      <option value="Squada One">Squada One</option>
      <option value="Bevan">Bevan</option>
      <option value="Limelight">Limelight</option>
      <option value="Syncopate">Syncopate</option>
      <option value="Six Caps">Six Caps</option>
      <option value="Ceviche One">Ceviche One</option>
      <option value="Faster One">Faster One</option>
      <option value="Metal Mania">Metal Mania</option>
      <option value="Nosifier">Nosifier</option>
      <option value="Rye">Rye</option>
      <option value="Sancreek">Sancreek</option>
      <option value="Trade Winds">Trade Winds</option>
      <option value="Wallpoet">Wallpoet</option>
      <option value="Yatra One">Yatra One</option>
      <option value="Akronim">Akronim</option>
      <option value="Butcherman">Butcherman</option>
      <option value="Chango">Chango</option>
      <option value="Creepster">Creepster</option>
      <option value="Eater">Eater</option>
      <option value="Flavors">Flavors</option>
      <option value="Gochi Hand">Gochi Hand</option>
      <option value="Henny Penny">Henny Penny</option>
      <option value="Holtwood One SC">Holtwood One SC</option>
      <option value="Jolly Lodger">Jolly Lodger</option>
      <option value="Kavoon">Kavoon</option>
      <option value="Knewave">Knewave</option>
      <option value="Lalezar">Lalezar</option>
      <option value="Leckerli One">Leckerli One</option>
      <option value="Love Ya Like A Sister">Love Ya Like A Sister</option>
      <option value="Macondo">Macondo</option>
      <option value="Luckiest Guy">Luckiest Guy</option>
      <option value="Neucha">Neucha</option>
    </select>
    <input type="color" id="font-color" value="#ffffff">
  </div>

  <div class="size-controls">
    <label id="size-label">Ukuran</label>
  </div>
  <input type="range" id="size-slider" min="12" max="80" value="30">

  <div class="btn-row">
    <label for="upload-photo">Upload Gambar</label>
    <input type="file" id="upload-photo" accept="image/*">
    <button id="remove-bg-btn">Remove Background</button>
    <button id="download-btn">Download</button>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/dom-to-image/2.6.0/dom-to-image.min.js"></script>
<script>
const namaInput = document.getElementById("nama-input");
const papanNama = document.getElementById("papan-nama");
const uploadPhoto = document.getElementById("upload-photo");
const userPhoto = document.getElementById("user-photo");
const photoWrapper = document.getElementById("photo-wrapper");
const downloadBtn = document.getElementById("download-btn");
const captureArea = document.getElementById("capture-area");
const fontSelect = document.getElementById("font-select");
const fontColor = document.getElementById("font-color");
const sizeLabel = document.getElementById("size-label");
const sizeSlider = document.getElementById("size-slider");
const removeBgBtn = document.getElementById("remove-bg-btn");

// Update nama
namaInput.addEventListener("input", () => { papanNama.textContent = namaInput.value; });

// Ganti font
fontSelect.addEventListener("change", () => { papanNama.style.fontFamily = fontSelect.value + ", sans-serif"; });

// Ganti warna font
fontColor.addEventListener("input", () => { papanNama.style.color = fontColor.value; });

// Toggle slider muncul
sizeLabel.addEventListener("click", () => {
  sizeSlider.style.display = sizeSlider.style.display === "block" ? "none" : "block";
});

// Ganti ukuran font
sizeSlider.addEventListener("input", () => { papanNama.style.fontSize = sizeSlider.value + "px"; });

// Upload foto
uploadPhoto.addEventListener("change", (e)=>{
  const file = e.target.files[0];
  if(file){
    const reader = new FileReader();
    reader.onload = function(evt){
      userPhoto.src = evt.target.result;
      photoWrapper.style.display = "block";
    };
    reader.readAsDataURL(file);
  }
});

// Remove Background
removeBgBtn.addEventListener("click", async ()=>{
  if(!userPhoto.src) return alert("Upload gambar dulu!");
  removeBgBtn.textContent = "Processing...";
  
  try {
    const file = dataURLtoFile(userPhoto.src,"userphoto.png");
    const formData = new FormData();
    formData.append("image_file", file);
    formData.append("size", "auto");

    const response = await fetch("https://api.remove.bg/v1.0/removebg", {
      method: "POST",
      headers: {
        "X-Api-Key": "AqDpBNSTdD88885CEJBkER5o"
      },
      body: formData
    });

    if(!response.ok) throw new Error("Gagal remove background");

    const blob = await response.blob();
    const url = URL.createObjectURL(blob);
    userPhoto.src = url;
    photoWrapper.style.display = "block";
  } catch(err) {
    alert("Error: " + err.message);
  } finally {
    removeBgBtn.textContent = "Remove Background";
  }
});

// Helper: dataURL -> File
function dataURLtoFile(dataurl, filename) {
  let arr = dataurl.split(','), mime = arr[0].match(/:(.*?);/)[1],
  bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);
  while(n--){ u8arr[n] = bstr.charCodeAt(n); }
  return new File([u8arr], filename, {type:mime});
}

// Drag & Resize
let isDragging=false,dragX,dragY;
function startDrag(x,y){isDragging=true; dragX=x-photoWrapper.offsetLeft; dragY=y-photoWrapper.offsetTop;}
function doDrag(x,y){if(isDragging){photoWrapper.style.left=(x-dragX)+"px"; photoWrapper.style.top=(y-dragY)+"px";}}
function endDrag(){isDragging=false;}
photoWrapper.addEventListener("mousedown",(e)=>{if(!e.target.classList.contains("resize-handle")) startDrag(e.clientX,e.clientY);});
document.addEventListener("mousemove",(e)=>doDrag(e.clientX,e.clientY));
document.addEventListener("mouseup",endDrag);
photoWrapper.addEventListener("touchstart",(e)=>{if(!e.target.classList.contains("resize-handle")){const t=e.touches[0]; startDrag(t.clientX,t.clientY);}});
document.addEventListener("touchmove",(e)=>{if(isDragging){const t=e.touches[0]; doDrag(t.clientX,t.clientY);}});
document.addEventListener("touchend",endDrag);

// Resize handles
const handles = document.querySelectorAll(".resize-handle");
let isResizing=false,currentHandle,startX,startY,startWidth,startHeight,startLeft,startTop,aspectRatio;
function startResize(x,y,handle){isResizing=true; currentHandle=handle; startX=x; startY=y; startWidth=photoWrapper.offsetWidth; startHeight=photoWrapper.offsetHeight; startLeft=photoWrapper.offsetLeft; startTop=photoWrapper.offsetTop; aspectRatio=startWidth/startHeight;}
function doResize(x,y){if(!isResizing)return; let dx=x-startX,dy=y-startY; 
if(currentHandle.classList.contains("br")){let w=startWidth+dx,h=w/aspectRatio; photoWrapper.style.width=w+"px"; photoWrapper.style.height=h+"px";}
else if(currentHandle.classList.contains("bl")){let w=startWidth-dx,h=w/aspectRatio; photoWrapper.style.width=w+"px"; photoWrapper.style.height=h+"px"; photoWrapper.style.left=startLeft+dx+"px";}
else if(currentHandle.classList.contains("tr")){let w=startWidth+dx,h=w/aspectRatio; photoWrapper.style.width=w+"px"; photoWrapper.style.height=h+"px"; photoWrapper.style.top=startTop+(startHeight-h)+"px";}
else if(currentHandle.classList.contains("tl")){let w=startWidth-dx,h=w/aspectRatio; photoWrapper.style.width=w+"px"; photoWrapper.style.height=h+"px"; photoWrapper.style.left=startLeft+dx+"px"; photoWrapper.style.top=startTop+(startHeight-h)+"px";}
else if(currentHandle.classList.contains("ml")){photoWrapper.style.width=startWidth-dx+"px"; photoWrapper.style.left=startLeft+dx+"px";}
else if(currentHandle.classList.contains("mr")){photoWrapper.style.width=startWidth+dx+"px";}
else if(currentHandle.classList.contains("mt")){photoWrapper.style.height=startHeight-dy+"px"; photoWrapper.style.top=startTop+dy+"px";}
else if(currentHandle.classList.contains("mb")){photoWrapper.style.height=startHeight+dy+"px";}}
function endResize(){isResizing=false;}
handles.forEach(h=>{
  h.addEventListener("mousedown",e=>{startResize(e.clientX,e.clientY,e.target); e.stopPropagation();});
  h.addEventListener("touchstart",e=>{const t=e.touches[0]; startResize(t.clientX,t.clientY,e.target); e.stopPropagation();});
});
document.addEventListener("mousemove",e=>doResize(e.clientX,e.clientY));
document.addEventListener("mouseup",endResize);
document.addEventListener("touchmove",e=>{const t=e.touches[0]; doResize(t.clientX,t.clientY);});
document.addEventListener("touchend",endResize);

// Auto hide resize
document.addEventListener("click",()=>{userPhoto.style.border="none"; handles.forEach(h=>h.style.display="none");});
photoWrapper.addEventListener("click",(e)=>{userPhoto.style.border="2px dashed rgba(255,255,255,0.4)"; handles.forEach(h=>h.style.display="block"); e.stopPropagation();});

// Download
downloadBtn.addEventListener("click",()=>{
  const oldBorder=userPhoto.style.border;
  userPhoto.style.border="none"; handles.forEach(h=>h.style.display="none");

  // Options for higher quality download
  const options = {
    quality: 0.95,
    width: 644 * 2,  // Double the width for better resolution
    height: 644 * 2  // Double the height
  };

  domtoimage.toPng(captureArea, options)
  .then(function (dataUrl) {
    const link = document.createElement('a');
    link.download = 'vip-agency.png';
    link.href = dataUrl;
    link.click();
    userPhoto.style.border=oldBorder; handles.forEach(h=>h.style.display="block");
  })
  .catch(function (error) {
    console.error('oops, something went wrong!', error);
    alert('Maaf, terjadi kesalahan saat mengunduh gambar.');
  });
});
</script>
</body>
</html>
.resize-handle {
  position: absolute;
  width:14px; height:14px;
  background: gold;
  border:2px solid black;
  border-radius:50%;
  z-index:5;
  touch-action:none;
}
.resize-handle.br { bottom:-8px; right:-8px; cursor: se-resize;}
.resize-handle.bl { bottom:-8px; left:-8px; cursor: sw-resize;}
.resize-handle.tr { top:-8px; right:-8px; cursor: ne-resize;}
.resize-handle.tl { top:-8px; left:-8px; cursor: nw-resize;}
.resize-handle.ml { top:50%; left:-8px; transform:translateY(-50%); cursor:w-resize;}
.resize-handle.mr { top:50%; right:-8px; transform:translateY(-50%); cursor:e-resize;}
.resize-handle.mt { top:-8px; left:50%; transform:translateX(-50%); cursor:n-resize;}
.resize-handle.mb { bottom:-8px; left:50%; transform:translateX(-50%); cursor:s-resize;}
#overlay { position:absolute; top:0; left:0; width:100%; height:100%; object-fit:cover; pointer-events:none; z-index:3; }
#papan-nama {
  position:absolute; bottom:16%; left:50%; transform:translateX(-50%);
  color:#fff; font-size:30px; font-weight:900; text-align:center;
  width:80%; font-family:'Montserrat',sans-serif;
  text-shadow: -2px -2px 4px rgba(0,0,0,0.8),
                2px -2px 4px rgba(0,0,0,0.8),
               -2px 2px 4px rgba(0,0,0,0.8),
                2px 2px 4px rgba(0,0,0,0.8);
  z-index:4;
}
.controls {
  margin-top:20px;
  display:flex;
  flex-direction:column;
  gap:10px;
  align-items:center;
  width:100%;
  max-width:420px;
}
input[type="text"], button, label, select, input[type="range"] {
  padding:10px 14px;
  border-radius:6px;
  border:none;
  font-size:16px;
  font-family:'Montserrat',sans-serif;
  width:100%;
  box-sizing:border-box;
}
button,label { cursor:pointer; background: gold; color:black; font-weight:700; text-align:center; }
#upload-photo { display:none; }
.btn-row { display:flex; flex-wrap:wrap; gap:10px; width:100%; }
.btn-row > * { flex:1; min-width:120px; }
.font-controls,.size-controls { display:flex; gap:10px; width:100%; }
.font-controls > *, .size-controls > * { flex:1; }
#size-slider { display:none; margin-top:5px; }
</style>
</head>
<body>
<div class="container" id="capture-area">
  <img class="bg" src="image/logoku.jpeg" alt="VIP Agency Background">
  <div id="photo-wrapper">
    <img id="user-photo" src="" alt="">
    <div class="resize-handle tl"></div>
    <div class="resize-handle tr"></div>
    <div class="resize-handle bl"></div>
    <div class="resize-handle br"></div>
    <div class="resize-handle ml"></div>
    <div class="resize-handle mr"></div>
    <div class="resize-handle mt"></div>
    <div class="resize-handle mb"></div>
  </div>
  <img id="overlay" src="image/lapisan.png" alt="Overlay">
  <div id="papan-nama">Tulis Nama</div>
</div>

<div class="controls">
  <input type="text" id="nama-input" placeholder="Masukkan nama">

  <div class="font-controls">
    <select id="font-select">
      <option value="Montserrat">Montserrat</option>
      <option value="Poppins">Poppins</option>
      <option value="Roboto">Roboto</option>
      <option value="Lato">Lato</option>
      <option value="Oswald">Oswald</option>
      <option value="Raleway">Raleway</option>
      <option value="Merriweather">Merriweather</option>
      <option value="Playfair Display">Playfair Display</option>
      <option value="Open Sans">Open Sans</option>
      <option value="Lora">Lora</option>
      <option value="Ubuntu">Ubuntu</option>
      <option value="Source Sans Pro">Source Sans Pro</option>
      <option value="Noto Sans">Noto Sans</option>
      <option value="Cabin">Cabin</option>
      <option value="Exo 2">Exo 2</option>
      <option value="Cormorant Garamond">Cormorant Garamond</option>
      <option value="Fira Sans">Fira Sans</option>
      <option value="Kanit">Kanit</option>
      <option value="Nunito">Nunito</option>
      <option value="Quicksand">Quicksand</option>
      <option value="Dosis">Dosis</option>
      <option value="Rubik">Rubik</option>
      <option value="Bitter">Bitter</option>
      <option value="Alegreya Sans">Alegreya Sans</option>
      <option value="Titillium Web">Titillium Web</option>
      <option value="Muli">Muli</option>
      <option value="Questrial">Questrial</option>
      <option value="Vollkorn">Vollkorn</option>
      <option value="Anton">Anton</option>
      <option value="Bebas Neue">Bebas Neue</option>
      <option value="Indie Flower">Indie Flower</option>
      <option value="Pacifico">Pacifico</option>
      <option value="Lobster">Lobster</option>
      <option value="Dancing Script">Dancing Script</option>
      <option value="Abril Fatface">Abril Fatface</option>
      <option value="Kaushan Script">Kaushan Script</option>
      <option value="Crete Round">Crete Round</option>
      <option value="Cinzel">Cinzel</option>
      <option value="Teko">Teko</option>
      <option value="Saira Condensed">Saira Condensed</option>
      <option value="Hind Siliguri">Hind Siliguri</option>
      <option value="Poiret One">Poiret One</option>
      <option value="Jura">Jura</option>
      <option value="Asap">Asap</option>
      <option value="PT Sans">PT Sans</option>
      <option value="Fjalla One">Fjalla One</option>
      <option value="Chivo">Chivo</option>
      <option value="Arvo">Arvo</option>
      <option value="Josefin Sans">Josefin Sans</option>
      <option value="Comfortaa">Comfortaa</option>
      <option value="Amatic SC">Amatic SC</option>
      <option value="Righteous">Righteous</option>
      <option value="Permanent Marker">Permanent Marker</option>
      <option value="Passion One">Passion One</option>
      <option value="Archivo Narrow">Archivo Narrow</option>
      <option value="Varela Round">Varela Round</option>
      <option value="Patua One">Patua One</option>
      <option value="Bungee">Bungee</option>
      <option value="Alfa Slab One">Alfa Slab One</option>
      <option value="Ultra">Ultra</option>
      <option value="Special Elite">Special Elite</option>
      <option value="Press Start 2P">Press Start 2P</option>
      <option value="Bangers">Bangers</option>
      <option value="Russo One">Russo One</option>
      <option value="Orbitron">Orbitron</option>
      <option value="Monoton">Monoton</option>
      <option value="Fugaz One">Fugaz One</option>
      <option value="Graduate">Graduate</option>
      <option value="Electrolize">Electrolize</option>
      <option value="Exo">Exo</option>
      <option value="Squada One">Squada One</option>
      <option value="Bevan">Bevan</option>
      <option value="Limelight">Limelight</option>
      <option value="Syncopate">Syncopate</option>
      <option value="Six Caps">Six Caps</option>
      <option value="Ceviche One">Ceviche One</option>
      <option value="Faster One">Faster One</option>
      <option value="Metal Mania">Metal Mania</option>
      <option value="Nosifier">Nosifier</option>
      <option value="Rye">Rye</option>
      <option value="Sancreek">Sancreek</option>
      <option value="Trade Winds">Trade Winds</option>
      <option value="Wallpoet">Wallpoet</option>
      <option value="Yatra One">Yatra One</option>
      <option value="Akronim">Akronim</option>
      <option value="Butcherman">Butcherman</option>
      <option value="Chango">Chango</option>
      <option value="Creepster">Creepster</option>
      <option value="Eater">Eater</option>
      <option value="Flavors">Flavors</option>
      <option value="Gochi Hand">Gochi Hand</option>
      <option value="Henny Penny">Henny Penny</option>
      <option value="Holtwood One SC">Holtwood One SC</option>
      <option value="Jolly Lodger">Jolly Lodger</option>
      <option value="Kavoon">Kavoon</option>
      <option value="Knewave">Knewave</option>
      <option value="Lalezar">Lalezar</option>
      <option value="Leckerli One">Leckerli One</option>
      <option value="Love Ya Like A Sister">Love Ya Like A Sister</option>
      <option value="Macondo">Macondo</option>
      <option value="Luckiest Guy">Luckiest Guy</option>
      <option value="Neucha">Neucha</option>
    </select>
    <input type="color" id="font-color" value="#ffffff">
  </div>

  <div class="size-controls">
    <label id="size-label" style="flex:0 0 auto;color:white;">Ukuran</label>
  </div>
  <input type="range" id="size-slider" min="12" max="80" value="30">

  <div class="btn-row">
    <label for="upload-photo">Upload Gambar</label>
    <input type="file" id="upload-photo" accept="image/*">
    <button id="remove-bg-btn">Remove Background</button>
    <button id="download-btn">Download</button>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/dom-to-image/2.6.0/dom-to-image.min.js"></script>
<script>
const namaInput = document.getElementById("nama-input");
const papanNama = document.getElementById("papan-nama");
const uploadPhoto = document.getElementById("upload-photo");
const userPhoto = document.getElementById("user-photo");
const photoWrapper = document.getElementById("photo-wrapper");
const downloadBtn = document.getElementById("download-btn");
const captureArea = document.getElementById("capture-area");
const fontSelect = document.getElementById("font-select");
const fontColor = document.getElementById("font-color");
const sizeLabel = document.getElementById("size-label");
const sizeSlider = document.getElementById("size-slider");
const removeBgBtn = document.getElementById("remove-bg-btn");

// Update nama
namaInput.addEventListener("input", () => { papanNama.textContent = namaInput.value; });

// Ganti font
fontSelect.addEventListener("change", () => { papanNama.style.fontFamily = fontSelect.value + ", sans-serif"; });

// Ganti warna font
fontColor.addEventListener("input", () => { papanNama.style.color = fontColor.value; });

// Toggle slider muncul
sizeLabel.addEventListener("click", () => {
  sizeSlider.style.display = sizeSlider.style.display === "block" ? "none" : "block";
});

// Ganti ukuran font
sizeSlider.addEventListener("input", () => { papanNama.style.fontSize = sizeSlider.value + "px"; });

// Upload foto
uploadPhoto.addEventListener("change", (e)=>{
  const file = e.target.files[0];
  if(file){
    const reader = new FileReader();
    reader.onload = function(evt){
      userPhoto.src = evt.target.result;
      photoWrapper.style.display = "block";
    };
    reader.readAsDataURL(file);
  }
});

// Remove Background
removeBgBtn.addEventListener("click", async ()=>{
  if(!userPhoto.src) return alert("Upload gambar dulu!");
  removeBgBtn.textContent = "Processing...";
  
  try {
    const file = dataURLtoFile(userPhoto.src,"userphoto.png");
    const formData = new FormData();
    formData.append("image_file", file);
    formData.append("size", "auto");

    const response = await fetch("https://api.remove.bg/v1.0/removebg", {
      method: "POST",
      headers: {
        "X-Api-Key": "iiqMWGJGBZr4BDCdxiucuzPw"
      },
      body: formData
    });

    if(!response.ok) throw new Error("Gagal remove background");

    const blob = await response.blob();
    const url = URL.createObjectURL(blob);
    userPhoto.src = url;
    photoWrapper.style.display = "block";
  } catch(err) {
    alert("Error: " + err.message);
  } finally {
    removeBgBtn.textContent = "Remove Background";
  }
});

// Helper: dataURL -> File
function dataURLtoFile(dataurl, filename) {
  let arr = dataurl.split(','), mime = arr[0].match(/:(.*?);/)[1],
  bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);
  while(n--){ u8arr[n] = bstr.charCodeAt(n); }
  return new File([u8arr], filename, {type:mime});
}

// Drag & Resize
let isDragging=false,dragX,dragY;
function startDrag(x,y){isDragging=true; dragX=x-photoWrapper.offsetLeft; dragY=y-photoWrapper.offsetTop;}
function doDrag(x,y){if(isDragging){photoWrapper.style.left=(x-dragX)+"px"; photoWrapper.style.top=(y-dragY)+"px";}}
function endDrag(){isDragging=false;}
photoWrapper.addEventListener("mousedown",(e)=>{if(!e.target.classList.contains("resize-handle")) startDrag(e.clientX,e.clientY);});
document.addEventListener("mousemove",(e)=>doDrag(e.clientX,e.clientY));
document.addEventListener("mouseup",endDrag);
photoWrapper.addEventListener("touchstart",(e)=>{if(!e.target.classList.contains("resize-handle")){const t=e.touches[0]; startDrag(t.clientX,t.clientY);}});
document.addEventListener("touchmove",(e)=>{if(isDragging){const t=e.touches[0]; doDrag(t.clientX,t.clientY);}});
document.addEventListener("touchend",endDrag);

// Resize handles
const handles = document.querySelectorAll(".resize-handle");
let isResizing=false,currentHandle,startX,startY,startWidth,startHeight,startLeft,startTop,aspectRatio;
function startResize(x,y,handle){isResizing=true; currentHandle=handle; startX=x; startY=y; startWidth=photoWrapper.offsetWidth; startHeight=photoWrapper.offsetHeight; startLeft=photoWrapper.offsetLeft; startTop=photoWrapper.offsetTop; aspectRatio=startWidth/startHeight;}
function doResize(x,y){if(!isResizing)return; let dx=x-startX,dy=y-startY; 
if(currentHandle.classList.contains("br")){let w=startWidth+dx,h=w/aspectRatio; photoWrapper.style.width=w+"px"; photoWrapper.style.height=h+"px";}
else if(currentHandle.classList.contains("bl")){let w=startWidth-dx,h=w/aspectRatio; photoWrapper.style.width=w+"px"; photoWrapper.style.height=h+"px"; photoWrapper.style.left=startLeft+dx+"px";}
else if(currentHandle.classList.contains("tr")){let w=startWidth+dx,h=w/aspectRatio; photoWrapper.style.width=w+"px"; photoWrapper.style.height=h+"px"; photoWrapper.style.top=startTop+(startHeight-h)+"px";}
else if(currentHandle.classList.contains("tl")){let w=startWidth-dx,h=w/aspectRatio; photoWrapper.style.width=w+"px"; photoWrapper.style.height=h+"px"; photoWrapper.style.left=startLeft+dx+"px"; photoWrapper.style.top=startTop+(startHeight-h)+"px";}
else if(currentHandle.classList.contains("ml")){photoWrapper.style.width=startWidth-dx+"px"; photoWrapper.style.left=startLeft+dx+"px";}
else if(currentHandle.classList.contains("mr")){photoWrapper.style.width=startWidth+dx+"px";}
else if(currentHandle.classList.contains("mt")){photoWrapper.style.height=startHeight-dy+"px"; photoWrapper.style.top=startTop+dy+"px";}
else if(currentHandle.classList.contains("mb")){photoWrapper.style.height=startHeight+dy+"px";}}
function endResize(){isResizing=false;}
handles.forEach(h=>{
  h.addEventListener("mousedown",e=>{startResize(e.clientX,e.clientY,e.target); e.stopPropagation();});
  h.addEventListener("touchstart",e=>{const t=e.touches[0]; startResize(t.clientX,t.clientY,e.target); e.stopPropagation();});
});
document.addEventListener("mousemove",e=>doResize(e.clientX,e.clientY));
document.addEventListener("mouseup",endResize);
document.addEventListener("touchmove",e=>{const t=e.touches[0]; doResize(t.clientX,t.clientY);});
document.addEventListener("touchend",endResize);

// Auto hide resize
document.addEventListener("click",()=>{userPhoto.style.border="none"; handles.forEach(h=>h.style.display="none");});
photoWrapper.addEventListener("click",(e)=>{userPhoto.style.border="2px dashed rgba(255,255,255,0.4)"; handles.forEach(h=>h.style.display="block"); e.stopPropagation();});

// Download
downloadBtn.addEventListener("click",()=>{
  const oldBorder=userPhoto.style.border;
  userPhoto.style.border="none"; handles.forEach(h=>h.style.display="none");

  domtoimage.toPng(captureArea)
  .then(function (dataUrl) {
    const link = document.createElement('a');
    link.download = 'vip-agency.png';
    link.href = dataUrl;
    link.click();
    userPhoto.style.border=oldBorder; handles.forEach(h=>h.style.display="block");
  })
  .catch(function (error) {
    console.error('oops, something went wrong!', error);
    alert('Maaf, terjadi kesalahan saat mengunduh gambar.');
  });
});
</script>
</body>
</html>


